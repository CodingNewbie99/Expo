#!/usr/bin/env node
'use strict';

const fs = require('fs');
const path = require('path');
const { commandRunner } = require("../util/commandUtils");

process.env.EXPO_NONINTERACTIVE = 1;

const run = async () => {
  console.log('expo-module-scripts: Configuring module');
  await commandRunner(path.join(__dirname, 'expo-module-clean'));
  await commandRunner(path.join(__dirname, 'expo-module-configure'));
  await commandRunner(path.join(__dirname, 'expo-module-build'));

  if (fs.existsSync(path.join(process.cwd(), 'plugin'))) {
    console.log('expo-module-scripts: Configuring plugin');
    await commandRunner(path.join(__dirname, 'expo-module-clean'), ['plugin']);
    await commandRunner(path.join(__dirname, 'expo-module-build'), ['plugin']);
  }
}

run();