{"version":3,"file":"hooks.js","sourceRoot":"","sources":["../../src/next/hooks.tsx"],"names":[],"mappings":"AAAA,OAAO,KAAK,EAAE,EAAE,aAAa,EAAE,UAAU,EAAE,SAAS,EAAE,QAAQ,EAAE,MAAM,OAAO,CAAC;AAE9E,OAAO,EAAE,iBAAiB,EAAY,MAAM,YAAY,CAAC;AA0BzD,2CAA2C;AAC3C,MAAM,aAAa,GAAG,aAAa,CAAkB,IAAI,CAAC,CAAC;AAE3D,8BAA8B;AAC9B,MAAM,UAAU,cAAc,CAAC,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,YAAY,EAAuB;IAC7F,MAAM,CAAC,QAAQ,EAAE,WAAW,CAAC,GAAG,QAAQ,CAAkB,IAAI,CAAC,CAAC;IAChE,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAG,QAAQ,CAAe,IAAI,CAAC,CAAC;IAEvD,SAAS,CAAC,GAAG,EAAE;QACb,KAAK,UAAU,KAAK;YAClB,IAAI;gBACF,MAAM,EAAE,GAAG,MAAM,iBAAiB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;gBACpD,WAAW,CAAC,EAAE,CAAC,CAAC;aACjB;YAAC,OAAO,CAAC,EAAE;gBACV,QAAQ,CAAC,CAAC,CAAC,CAAC;aACb;QACH,CAAC;QAED,KAAK,UAAU,QAAQ;YACrB,IAAI;gBACF,MAAM,QAAQ,EAAE,UAAU,EAAE,CAAC;aAC9B;YAAC,OAAO,CAAC,EAAE;gBACV,QAAQ,CAAC,CAAC,CAAC,CAAC;aACb;QACH,CAAC;QAED,KAAK,EAAE,CAAC;QAER,OAAO,GAAG,EAAE;YACV,QAAQ,EAAE,CAAC;QACb,CAAC,CAAC;IACJ,CAAC,EAAE,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC;IAEtB,IAAI,KAAK,IAAI,IAAI,EAAE;QACjB,MAAM,OAAO,GACX,YAAY;YACZ,CAAC,CAAC,CAAC,EAAE,EAAE;gBACL,MAAM,CAAC,CAAC;YACV,CAAC,CAAC,CAAC;QACL,OAAO,CAAC,KAAK,CAAC,CAAC;KAChB;IAED,IAAI,QAAQ,IAAI,IAAI,EAAE;QACpB,OAAO,IAAI,CAAC;KACb;IACD,OAAO,CAAC,aAAa,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,aAAa,CAAC,QAAQ,CAAC,CAAC;AACtF,CAAC;AAED,0DAA0D;AAC1D,MAAM,UAAU,gBAAgB;IAC9B,MAAM,OAAO,GAAG,UAAU,CAAC,aAAa,CAAC,CAAC;IAC1C,IAAI,OAAO,IAAI,IAAI,EAAE;QACnB,MAAM,IAAI,KAAK,CAAC,yDAAyD,CAAC,CAAC;KAC5E;IACD,OAAO,OAAO,CAAC;AACjB,CAAC","sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react';\n\nimport { openDatabaseAsync, Database } from './Database';\nimport type { OpenOptions } from './NativeDatabase';\n\nexport interface SQLiteProviderProps {\n  /**\n   * The name of the database file to open.\n   */\n  dbName: string;\n\n  /**\n   * Open options.\n   */\n  options?: OpenOptions;\n\n  /**\n   * The children to render.\n   */\n  children: React.ReactNode;\n\n  /**\n   * Handle errors from SQLiteProvider.\n   * @default throw\n   */\n  errorHandler?: (error: Error) => void;\n}\n\n// Create a context for the SQLite database\nconst SQLiteContext = createContext<Database | null>(null);\n\n// Create a provider component\nexport function SQLiteProvider({ dbName, options, children, errorHandler }: SQLiteProviderProps) {\n  const [database, setDatabase] = useState<Database | null>(null);\n  const [error, setError] = useState<Error | null>(null);\n\n  useEffect(() => {\n    async function setup() {\n      try {\n        const db = await openDatabaseAsync(dbName, options);\n        setDatabase(db);\n      } catch (e) {\n        setError(e);\n      }\n    }\n\n    async function teardown() {\n      try {\n        await database?.closeAsync();\n      } catch (e) {\n        setError(e);\n      }\n    }\n\n    setup();\n\n    return () => {\n      teardown();\n    };\n  }, [dbName, options]);\n\n  if (error != null) {\n    const handler =\n      errorHandler ??\n      ((e) => {\n        throw e;\n      });\n    handler(error);\n  }\n\n  if (database == null) {\n    return null;\n  }\n  return <SQLiteContext.Provider value={database}>{children}</SQLiteContext.Provider>;\n}\n\n// Create a hook for accessing the SQLite database context\nexport function useSQLiteContext() {\n  const context = useContext(SQLiteContext);\n  if (context == null) {\n    throw new Error('useSQLiteContext must be used within a <SQLiteProvider>');\n  }\n  return context;\n}\n"]}